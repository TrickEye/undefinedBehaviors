
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://trickeye.github.io/undefinedBehaviors/UB21to40/UB21/">
      
      
        <link rel="prev" href="../../UB1to20/UB7/">
      
      
        <link rel="next" href="../UB22/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>UB21 - Undefined Behaviors in C</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ub21" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Undefined Behaviors in C" class="md-header__button md-logo" aria-label="Undefined Behaviors in C" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Undefined Behaviors in C
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UB21
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/TrickEye/undefinedBehaviors" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    undefinedBehaviors
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Hello!
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../template/" class="md-tabs__link">
      Template
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../UB1to20/UB02/" class="md-tabs__link">
        UB1to20
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        UB21to40
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../UB41to60/UB41/" class="md-tabs__link">
        UB41to60
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Undefined Behaviors in C" class="md-nav__button md-logo" aria-label="Undefined Behaviors in C" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Undefined Behaviors in C
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TrickEye/undefinedBehaviors" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    undefinedBehaviors
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Hello!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../template/" class="md-nav__link">
        Template
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          UB1to20
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          UB1to20
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB02/" class="md-nav__link">
        UB02
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB03/" class="md-nav__link">
        UB03
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB04/" class="md-nav__link">
        UB04
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB11/" class="md-nav__link">
        UB11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB12/" class="md-nav__link">
        UB12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB13/" class="md-nav__link">
        UB13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB14/" class="md-nav__link">
        UB14
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB15/" class="md-nav__link">
        UB15
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB16/" class="md-nav__link">
        UB16
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB17/" class="md-nav__link">
        UB17
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB18/" class="md-nav__link">
        UB18
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB19/" class="md-nav__link">
        UB19
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB20/" class="md-nav__link">
        UB20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB1to20/UB7/" class="md-nav__link">
        UB7
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          UB21to40
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          UB21to40
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          UB21
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        UB21
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition" class="md-nav__link">
    Definition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurations" class="md-nav__link">
    Configurations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#behaviors" class="md-nav__link">
    Behaviors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advice" class="md-nav__link">
    Advice
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB22/" class="md-nav__link">
        UB22
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB23/" class="md-nav__link">
        UB23
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB24/" class="md-nav__link">
        UB24
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB25/" class="md-nav__link">
        UB25
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB26/" class="md-nav__link">
        UB26
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB28/" class="md-nav__link">
        UB28
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB29/" class="md-nav__link">
        UB29
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB31/" class="md-nav__link">
        UB31
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB32/" class="md-nav__link">
        UB32
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB33/" class="md-nav__link">
        UB33
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB34/" class="md-nav__link">
        UB34
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB39/" class="md-nav__link">
        UB39
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UB40/" class="md-nav__link">
        UB40
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          UB41to60
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          UB41to60
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB41/" class="md-nav__link">
        UB41
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB42/" class="md-nav__link">
        UB42
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB43/" class="md-nav__link">
        UB43
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB46/" class="md-nav__link">
        UB46
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB47/" class="md-nav__link">
        UB47
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB48/" class="md-nav__link">
        UB48
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB49/" class="md-nav__link">
        UB49
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB50/" class="md-nav__link">
        UB50
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB51/" class="md-nav__link">
        UB51
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB54/" class="md-nav__link">
        Ub54
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB56/" class="md-nav__link">
        UB56
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB58/" class="md-nav__link">
        UB58
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB59/" class="md-nav__link">
        UB59
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../UB41to60/UB60/" class="md-nav__link">
        UB60
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition" class="md-nav__link">
    Definition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurations" class="md-nav__link">
    Configurations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#behaviors" class="md-nav__link">
    Behaviors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advice" class="md-nav__link">
    Advice
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  



  
  


<h1 id="ub21">UB21<a class="headerlink" href="#ub21" title="link to this position">⚓︎</a></h1>
<p>Author: Yikai Cui.</p>
<h2 id="definition">Definition<a class="headerlink" href="#definition" title="link to this position">⚓︎</a></h2>
<p><strong>An lvalue having array type is converted to a pointer to the initial element of the array, and the array object has register storage class (6.3.2.1)</strong></p>
<p>当一个具有数组类型的左值被转换成了指向数组首个元素的指针，而该数组具有register存储类型时。</p>
<h2 id="description">Description<a class="headerlink" href="#description" title="link to this position">⚓︎</a></h2>
<p>Except when it is the operand of the <code>sizeof</code> operator, or typeof operators, or the unary &amp; operator, or is a string literal used to initialize an array, an expression that has type "array of <em>type</em>" is converted to an expression with type "pointer to <em>type</em>" that points to the initial element of the array object and is not an lvalue. If the array object has register storage class, the behavior is undefined. (from ISO/IEC 9899:2023(E) 6.3.2.1, 3)</p>
<p>一个类型为“某个类的数组”的表达式会被转换成类型为“指向这个类”的指针的表达式，具体指向数组的首个对象，并且不是左值，除非作为<code>sizeof</code>操作符、<code>typeof</code>操作、单元运算符<code>&amp;</code>的操作数，或者一个字符串常量被用于初始化数组。如果数组对象具有register存储类型，那么行为是未定义的。</p>
<p>As stated in <a href="../../UB1to20/UB20/">Undefined Behavior # 20</a>, the address of any part of a <strong>register</strong> object cannot be computed. By converting an array expression to a pointer expression, the address of the first element of the array will taken during the evaluation of the converted expression. Thus we cannot determine the behavior of such conversion of the <strong>register</strong> array expression.</p>
<p>在<a href="../../UB1to20/UB20/">第20条未定义行为</a>中有介绍：一个具有“register”存储类型的对象的任何一部分的地址都不能被以直接或间接方式计算。通过上述的这种从数组类型到指针类型的转换，将会在接下来的“evaluation”过程中计算数组首个元素的地址。因此无法确定这种操作的行为。</p>
<h2 id="code">Code<a class="headerlink" href="#code" title="link to this position">⚓︎</a></h2>
<div class="highlight"><span class="filename">UB21.1.c</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="k">register</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">);</span><span class="w">      </span><span class="c1">// undefined behavior! (1)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</code></pre></div>
<ol>
<li>Undefined behavior! Here <code>arr</code> is an array of <em>int</em>, which will be converted to a pointer to <em>int</em>, of whom the evaluation would cause an undefined behavior.</li>
</ol>
<p><a href="../UB21.1.c">View source</a></p>
<hr />
<div class="highlight"><span class="filename">UB21.2.c</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="k">register</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="w">   </span><span class="c1">// undefined behavior! (1)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">}</span>
</code></pre></div>
<ol>
<li>Undefined behavior! Here <code>arr[2]</code> is seen as <code>* (arr + 2)</code> (see array subscripting (6.5.2.1)), which also includes array-to-pointer conversion.</li>
</ol>
<p><a href="../UB21.2.c">View source</a></p>
<h2 id="configurations">Configurations<a class="headerlink" href="#configurations" title="link to this position">⚓︎</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><input id="__tabbed_1_6" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">UB21.1.c MinGW</label><label for="__tabbed_1_2">UB21.1.c MSVC</label><label for="__tabbed_1_3">UB21.1.c Clang</label><label for="__tabbed_1_4">UB21.2.c MinGW</label><label for="__tabbed_1_5">UB21.2.c MSVC</label><label for="__tabbed_1_6">UB21.2.c Clang</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>OS: Microsoft Windows 11 22H2</p>
<p><code>gcc -v</code> : <code>gcc version 11.2.0 (GCC)</code>, <code>x86_64-w64-mingw32</code></p>
<p>compile and run commands: <code>gcc UB21.1.c -o UB21.1.exe &amp;&amp; ./UB21.1.exe</code></p>
</div>
<div class="tabbed-block">
<p>OS: Microsoft Windows 11 22H2</p>
<p>cl.exe Version Code: <code>19.35.32215</code>, Arcitecture: <code>amd64</code>, Version: <code>8.1 or Windows 10 SDK version</code></p>
<p>compile and run commands: <code>cl.exe /FeUB21.1 UB21.1.c &amp;&amp; ./UB21.1.exe</code></p>
</div>
<div class="tabbed-block">
<p>OS: Ubuntu 20.04 x86_64 GNU/Linux</p>
<p><code>clang -v</code> : <code>17.0.0</code>, <code>Target: x86_64-pc-linux-gnu</code></p>
<p>compile and run commands: <code>clang UB21.1.c -o UB21.1.exe &amp;&amp; ./UB21.1.exe</code></p>
</div>
<div class="tabbed-block">
<p>OS and <code>gcc -v</code>: same as <code>UB21.1.c MinGW</code></p>
<p>compile and run commands: <code>gcc UB21.2.c -o UB21.2.exe &amp;&amp; ./UB21.2.exe</code></p>
</div>
<div class="tabbed-block">
<p>OS and cl.exe version: same as <code>UB21.1.c MSVC</code></p>
<p>compile and run commands: <code>cl.exe /FeUB21.2 UB21.2.c &amp;&amp; ./UB21.2.exe</code></p>
</div>
<div class="tabbed-block">
<p>OS and <code>clang -v</code>: same as <code>UB21.1.c Clang</code></p>
<p>compile and run commands: <code>clang UB21.2.c -o UB21.2.exe &amp;&amp; ./UB21.2.exe</code></p>
</div>
</div>
</div>
<h2 id="behaviors">Behaviors<a class="headerlink" href="#behaviors" title="link to this position">⚓︎</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="2:6"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><input id="__tabbed_2_5" name="__tabbed_2" type="radio" /><input id="__tabbed_2_6" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">UB21.1.c MinGW</label><label for="__tabbed_2_2">UB21.1.c MSVC</label><label for="__tabbed_2_3">UB21.1.c Clang</label><label for="__tabbed_2_4">UB21.2.c MinGW</label><label for="__tabbed_2_5">UB21.2.c MSVC</label><label for="__tabbed_2_6">UB21.2.c Clang</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>Compilation unsuccessful</li>
<li>Compiler messages: "error: address of register variable 'arr' requested"</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>Compilation unsuccessful</li>
<li>Compiler messages: "error C2103: '&amp;' on register variable"</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>Compilation unsuccessful</li>
<li>Compiler messages: "error: address of register variable requested"</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>Compilation <strong>successful</strong></li>
<li>Output: 0</li>
<li>Note: If we take a look at the assembly script the compiler generates, we find out that the array <code>arr</code> is actually <strong>in</strong> the registers. MinGW takes a different approach to translate <code>arr[2]</code>, directly reading from the compiler instead of array subscripting.</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>Compilation unsuccessful</li>
<li>Compiler messages: "error C2103: '&amp;' on register variable"</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>Compilation unsuccessful</li>
<li>Compiler messages: "error: address of register variable requested"</li>
</ul>
</div>
</div>
</div>
<h2 id="advice">Advice<a class="headerlink" href="#advice" title="link to this position">⚓︎</a></h2>
<p>As we see in the <a href="#behaviors">behaviors</a> part, the use of an element of a register array will cause compatibility issue (e.g. UB21.2.c, which uses <code>arr[1]</code>, can be compiled in MinGW, while fails with MSCV and Clang). And given that array subscripting is one of the most frequently used operation on an array. Therefore programmers should avoid using register arrays when coding.</p>
<p>In author's opinion, the register array is actually quite awkward. If a register array is too long, compiler cannot put it into register file for faster accessing latency. If a register array is short enough to fit into register file, then using a bunch of register variables will be a better solution, avoiding array subscripting problem.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "content.code.annotate", "content.tabs.link", "search.suggest", "navigation.instant", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.407015b8.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>